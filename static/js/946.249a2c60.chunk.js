"use strict";(self.webpackChunk_3d_examples=self.webpackChunk_3d_examples||[]).push([[946],{1935:function(t,e,r){r.d(e,{xC:function(){return c}});var i=r(5671),n=r(3144),s=r(3562),a=r(3500),o=r(136),l=r(4062),u=r(6531),h=function(t){(0,o.Z)(r,t);var e=(0,l.Z)(r);function r(t,n){var a;return(0,i.Z)(this,r),(a=e.call(this)).textureID=void 0!==n?n:"tDiffuse",t instanceof s.jyz?(a.uniforms=t.uniforms,a.material=t):t&&(a.uniforms=s.rDY.clone(t.uniforms),a.material=new s.jyz({defines:Object.assign({},t.defines),uniforms:a.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader})),a.fsQuad=new u.T(a.material),a}return(0,n.Z)(r,[{key:"render",value:function(t,e,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.fsQuad.material=this.material,this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(e),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),this.fsQuad.render(t))}}]),r}(u.w),f=function(t){(0,o.Z)(r,t);var e=(0,l.Z)(r);function r(t,n){var s;return(0,i.Z)(this,r),(s=e.call(this)).scene=t,s.camera=n,s.clear=!0,s.needsSwap=!1,s.inverse=!1,s}return(0,n.Z)(r,[{key:"render",value:function(t,e,r){var i,n,s=t.getContext(),a=t.state;a.buffers.color.setMask(!1),a.buffers.depth.setMask(!1),a.buffers.color.setLocked(!0),a.buffers.depth.setLocked(!0),this.inverse?(i=0,n=1):(i=1,n=0),a.buffers.stencil.setTest(!0),a.buffers.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),a.buffers.stencil.setFunc(s.ALWAYS,i,4294967295),a.buffers.stencil.setClear(n),a.buffers.stencil.setLocked(!0),t.setRenderTarget(r),this.clear&&t.clear(),t.render(this.scene,this.camera),t.setRenderTarget(e),this.clear&&t.clear(),t.render(this.scene,this.camera),a.buffers.color.setLocked(!1),a.buffers.depth.setLocked(!1),a.buffers.stencil.setLocked(!1),a.buffers.stencil.setFunc(s.EQUAL,1,4294967295),a.buffers.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),a.buffers.stencil.setLocked(!0)}}]),r}(u.w),d=function(t){(0,o.Z)(r,t);var e=(0,l.Z)(r);function r(){var t;return(0,i.Z)(this,r),(t=e.call(this)).needsSwap=!1,t}return(0,n.Z)(r,[{key:"render",value:function(t){t.state.buffers.stencil.setLocked(!1),t.state.buffers.stencil.setTest(!1)}}]),r}(u.w),c=function(){function t(e,r){if((0,i.Z)(this,t),this.renderer=e,void 0===r){var n={minFilter:s.wem,magFilter:s.wem,format:s.wk1},o=e.getSize(new s.FM8);this._pixelRatio=e.getPixelRatio(),this._width=o.width,this._height=o.height,(r=new s.dd2(this._width*this._pixelRatio,this._height*this._pixelRatio,n)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=r.width,this._height=r.height;this.renderTarget1=r,this.renderTarget2=r.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===a.C&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===h&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new h(a.C),this.clock=new s.SUY}return(0,n.Z)(t,[{key:"swapBuffers",value:function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t}},{key:"addPass",value:function(t){this.passes.push(t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}},{key:"insertPass",value:function(t,e){this.passes.splice(e,0,t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}},{key:"removePass",value:function(t){var e=this.passes.indexOf(t);-1!==e&&this.passes.splice(e,1)}},{key:"isLastEnabledPass",value:function(t){for(var e=t+1;e<this.passes.length;e++)if(this.passes[e].enabled)return!1;return!0}},{key:"render",value:function(t){void 0===t&&(t=this.clock.getDelta());for(var e=this.renderer.getRenderTarget(),r=!1,i=0,n=this.passes.length;i<n;i++){var s=this.passes[i];if(!1!==s.enabled){if(s.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(i),s.render(this.renderer,this.writeBuffer,this.readBuffer,t,r),s.needsSwap){if(r){var a=this.renderer.getContext(),o=this.renderer.state.buffers.stencil;o.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),o.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==f&&(s instanceof f?r=!0:s instanceof d&&(r=!1))}}this.renderer.setRenderTarget(e)}},{key:"reset",value:function(t){if(void 0===t){var e=this.renderer.getSize(new s.FM8);this._pixelRatio=this.renderer.getPixelRatio(),this._width=e.width,this._height=e.height,(t=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}},{key:"setSize",value:function(t,e){this._width=t,this._height=e;var r=this._width*this._pixelRatio,i=this._height*this._pixelRatio;this.renderTarget1.setSize(r,i),this.renderTarget2.setSize(r,i);for(var n=0;n<this.passes.length;n++)this.passes[n].setSize(r,i)}},{key:"setPixelRatio",value:function(t){this._pixelRatio=t,this.setSize(this._width,this._height)}}]),t}(),v=(new s.iKG(-1,1,1,-1,0,1),new s.u9r);v.setAttribute("position",new s.a$l([-1,3,0,-1,-1,0,3,-1,0],3)),v.setAttribute("uv",new s.a$l([0,2,0,0,2,0],2))},7107:function(t,e,r){r.d(e,{C:function(){return h}});var i=r(5671),n=r(3144),s=r(136),a=r(4062),o=r(3562),l=r(6531),u={uniforms:{tDiffuse:{value:null},tDisp:{value:null},byp:{value:0},amount:{value:.08},angle:{value:.02},seed:{value:.02},seed_x:{value:.02},seed_y:{value:.02},distortion_x:{value:.5},distortion_y:{value:.6},col_s:{value:.05}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\t\tvoid main() {\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t}",fragmentShader:"\n\n\t\tuniform int byp; //should we apply the glitch ?\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform sampler2D tDisp;\n\n\t\tuniform float amount;\n\t\tuniform float angle;\n\t\tuniform float seed;\n\t\tuniform float seed_x;\n\t\tuniform float seed_y;\n\t\tuniform float distortion_x;\n\t\tuniform float distortion_y;\n\t\tuniform float col_s;\n\n\t\tvarying vec2 vUv;\n\n\n\t\tfloat rand(vec2 co){\n\t\t\treturn fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n\t\t}\n\n\t\tvoid main() {\n\t\t\tif(byp<1) {\n\t\t\t\tvec2 p = vUv;\n\t\t\t\tfloat xs = floor(gl_FragCoord.x / 0.5);\n\t\t\t\tfloat ys = floor(gl_FragCoord.y / 0.5);\n\t\t\t\t//based on staffantans glitch shader for unity https://github.com/staffantan/unityglitch\n\t\t\t\tvec4 normal = texture2D (tDisp, p*seed*seed);\n\t\t\t\tif(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {\n\t\t\t\t\tif(seed_x>0.){\n\t\t\t\t\t\tp.y = 1. - (p.y + distortion_y);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tp.y = distortion_y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {\n\t\t\t\t\tif(seed_y>0.){\n\t\t\t\t\t\tp.x=distortion_x;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tp.x = 1. - (p.x + distortion_x);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tp.x+=normal.x*seed_x*(seed/5.);\n\t\t\t\tp.y+=normal.y*seed_y*(seed/5.);\n\t\t\t\t//base from RGB shift shader\n\t\t\t\tvec2 offset = amount * vec2( cos(angle), sin(angle));\n\t\t\t\tvec4 cr = texture2D(tDiffuse, p + offset);\n\t\t\t\tvec4 cga = texture2D(tDiffuse, p);\n\t\t\t\tvec4 cb = texture2D(tDiffuse, p - offset);\n\t\t\t\tgl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);\n\t\t\t\t//add noise\n\t\t\t\tvec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);\n\t\t\t\tgl_FragColor = gl_FragColor+ snow;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tgl_FragColor=texture2D (tDiffuse, vUv);\n\t\t\t}\n\t\t}"},h=function(t){(0,s.Z)(r,t);var e=(0,a.Z)(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:64;(0,i.Z)(this,r),t=e.call(this),void 0===u&&console.error("THREE.GlitchPass relies on DigitalGlitch");var s=u;return t.uniforms=o.rDY.clone(s.uniforms),t.uniforms.tDisp.value=t.generateHeightmap(n),t.material=new o.jyz({uniforms:t.uniforms,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader}),t.fsQuad=new l.T(t.material),t.goWild=!1,t.curF=0,t.generateTrigger(),t}return(0,n.Z)(r,[{key:"render",value:function(t,e,r){this.uniforms.tDiffuse.value=r.texture,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this.curF%this.randX==0||1==this.goWild?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=o.M8C.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=o.M8C.randFloat(-1,1),this.uniforms.seed_y.value=o.M8C.randFloat(-1,1),this.uniforms.distortion_x.value=o.M8C.randFloat(0,1),this.uniforms.distortion_y.value=o.M8C.randFloat(0,1),this.curF=0,this.generateTrigger()):this.curF%this.randX<this.randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=o.M8C.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=o.M8C.randFloat(0,1),this.uniforms.distortion_y.value=o.M8C.randFloat(0,1),this.uniforms.seed_x.value=o.M8C.randFloat(-.3,.3),this.uniforms.seed_y.value=o.M8C.randFloat(-.3,.3)):0==this.goWild&&(this.uniforms.byp.value=1),this.curF++,this.renderToScreen?(t.setRenderTarget(null),this.fsQuad.render(t)):(t.setRenderTarget(e),this.clear&&t.clear(),this.fsQuad.render(t))}},{key:"generateTrigger",value:function(){this.randX=o.M8C.randInt(120,240)}},{key:"generateHeightmap",value:function(t){for(var e=new Float32Array(t*t*3),r=t*t,i=0;i<r;i++){var n=o.M8C.randFloat(0,1);e[3*i+0]=n,e[3*i+1]=n,e[3*i+2]=n}var s=new o.IEO(e,t,t,o.UCm,o.VzW);return s.needsUpdate=!0,s}}]),r}(l.w)},6531:function(t,e,r){r.d(e,{T:function(){return u},w:function(){return a}});var i=r(5671),n=r(3144),s=r(3562),a=function(){function t(){(0,i.Z)(this,t),this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}return(0,n.Z)(t,[{key:"setSize",value:function(){}},{key:"render",value:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}]),t}(),o=new s.iKG(-1,1,1,-1,0,1),l=new s.u9r;l.setAttribute("position",new s.a$l([-1,3,0,-1,-1,0,3,-1,0],3)),l.setAttribute("uv",new s.a$l([0,2,0,0,2,0],2));var u=function(){function t(e){(0,i.Z)(this,t),this._mesh=new s.Kj0(l,e)}return(0,n.Z)(t,[{key:"dispose",value:function(){this._mesh.geometry.dispose()}},{key:"render",value:function(t){t.render(this._mesh,o)}},{key:"material",get:function(){return this._mesh.material},set:function(t){this._mesh.material=t}}]),t}()},6938:function(t,e,r){r.d(e,{C:function(){return l}});var i=r(5671),n=r(3144),s=r(136),a=r(4062),o=r(3562),l=function(t){(0,s.Z)(r,t);var e=(0,a.Z)(r);function r(t,n,s,a,l){var u;return(0,i.Z)(this,r),(u=e.call(this)).scene=t,u.camera=n,u.overrideMaterial=s,u.clearColor=a,u.clearAlpha=void 0!==l?l:0,u.clear=!0,u.clearDepth=!1,u.needsSwap=!1,u._oldClearColor=new o.Ilk,u}return(0,n.Z)(r,[{key:"render",value:function(t,e,r){var i,n,s=t.autoClear;t.autoClear=!1,void 0!==this.overrideMaterial&&(n=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(t.getClearColor(this._oldClearColor),i=t.getClearAlpha(),t.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&t.clearDepth(),t.setRenderTarget(this.renderToScreen?null:r),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),t.render(this.scene,this.camera),this.clearColor&&t.setClearColor(this._oldClearColor,i),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=n),t.autoClear=s}}]),r}(r(6531).w)},3500:function(t,e,r){r.d(e,{C:function(){return i}});var i={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\t\t}"}}}]);