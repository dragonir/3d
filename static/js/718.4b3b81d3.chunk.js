(self.webpackChunk_3d_examples=self.webpackChunk_3d_examples||[]).push([[718],{5718:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return U}});var n=r(4165),i=r(5861),o=r(9611),a=r(8814);function s(e,t,r){return s=(0,a.Z)()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&(0,o.Z)(i,r.prototype),i},s.apply(null,arguments)}var l=r(2982),u=r(5671),c=r(3144),h=r(136),d=r(9388),f=r(7313),v=r(3562),m=r(2518),p=r(6892),g=r(4849),w=r(40),y=r(6938),_=r(1935),b=r(3500),T=r(5349);function x(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}Object.assign(x.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),x.FullScreenQuad=function(){var e=new v.iKG(-1,1,1,-1,0,1),t=new v._12(2,2),r=function(e){this._mesh=new v.Kj0(t,e)};return Object.defineProperty(r.prototype,"material",{get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}),Object.assign(r.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(t){t.render(this._mesh,e)}}),r}();var C=function(e,t,r,n){x.call(this),this.strength=void 0!==t?t:1,this.radius=r,this.threshold=n,this.resolution=void 0!==e?new v.FM8(e.x,e.y):new v.FM8(256,256),this.clearColor=new v.Ilk(0,0,0);var i={minFilter:v.wem,magFilter:v.wem,format:v.wk1};this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;var o=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2);this.renderTargetBright=new v.dd2(o,a,i),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(var s=0;s<this.nMips;s++){var l=new v.dd2(o,a,i);l.texture.name="UnrealBloomPass.h"+s,l.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(l);var u=new v.dd2(o,a,i);u.texture.name="UnrealBloomPass.v"+s,u.texture.generateMipmaps=!1,this.renderTargetsVertical.push(u),o=Math.round(o/2),a=Math.round(a/2)}void 0===T.Y&&console.error("UnrealBloomPass relies on LuminosityHighPassShader");var c=T.Y;this.highPassUniforms=v.rDY.clone(c.uniforms),this.highPassUniforms.luminosityThreshold.value=n,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new v.jyz({uniforms:this.highPassUniforms,vertexShader:c.vertexShader,fragmentShader:c.fragmentShader,defines:{}}),this.separableBlurMaterials=[];var h=[3,5,7,9,11];for(o=Math.round(this.resolution.x/2),a=Math.round(this.resolution.y/2),s=0;s<this.nMips;s++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(h[s])),this.separableBlurMaterials[s].uniforms.texSize.value=new v.FM8(o,a),o=Math.round(o/2),a=Math.round(a/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0;this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new v.Pa4(1,1,1),new v.Pa4(1,1,1),new v.Pa4(1,1,1),new v.Pa4(1,1,1),new v.Pa4(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,void 0===b.C&&console.error("UnrealBloomPass relies on CopyShader");var d=b.C;this.copyUniforms=v.rDY.clone(d.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new v.jyz({uniforms:this.copyUniforms,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,blending:v.WMw,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new v.Ilk,this.oldClearAlpha=1,this.basic=new v.vBJ,this.fsQuad=new x.FullScreenQuad(null)};C.prototype=Object.assign(Object.create(x.prototype),{constructor:C,dispose:function(){for(var e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()},setSize:function(e,t){var r=Math.round(e/2),n=Math.round(t/2);this.renderTargetBright.setSize(r,n);for(var i=0;i<this.nMips;i++)this.renderTargetsHorizontal[i].setSize(r,n),this.renderTargetsVertical[i].setSize(r,n),this.separableBlurMaterials[i].uniforms.texSize.value=new v.FM8(r,n),r=Math.round(r/2),n=Math.round(n/2)},render:function(e,t,r,n,i){this.oldClearColor.copy(e.getClearColor(new v.Ilk(0))),this.oldClearAlpha=e.getClearAlpha();var o=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),i&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=r.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=r.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);for(var a=this.renderTargetBright,s=0;s<this.nMips;s++)this.fsQuad.material=this.separableBlurMaterials[s],this.separableBlurMaterials[s].uniforms.colorTexture.value=a.texture,this.separableBlurMaterials[s].uniforms.direction.value=C.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[s]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[s].uniforms.colorTexture.value=this.renderTargetsHorizontal[s].texture,this.separableBlurMaterials[s].uniforms.direction.value=C.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[s]),e.clear(),this.fsQuad.render(e),a=this.renderTargetsVertical[s];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,i&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(r),this.fsQuad.render(e)),e.setClearColor(this.oldClearColor,this.oldClearAlpha),e.autoClear=o},getSeperableBlurMaterial:function(e){return new v.jyz({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new v.FM8(.5,.5)},direction:{value:new v.FM8(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat fSigma = float(SIGMA);\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\t\t\t\t\tfloat alphaSum = 0.0;\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\t\t\t\t\t\tfloat x = float(i);\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\t\t\t\t\t\tvec4 sample1 = texture2D( colorTexture, vUv + uvOffset);\t\t\t\t\t\tvec4 sample2 = texture2D( colorTexture, vUv - uvOffset);\t\t\t\t\t\tdiffuseSum += (sample1.rgb + sample2.rgb) * w;\t\t\t\t\t\talphaSum += (sample1.a + sample2.a) * w;\t\t\t\t\t\tweightSum += 2.0 * w;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, alphaSum/weightSum);\n\t\t\t\t}"})},getCompositeMaterial:function(e){return new v.jyz({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D blurTexture1;\t\t\t\tuniform sampler2D blurTexture2;\t\t\t\tuniform sampler2D blurTexture3;\t\t\t\tuniform sampler2D blurTexture4;\t\t\t\tuniform sampler2D blurTexture5;\t\t\t\tuniform sampler2D dirtTexture;\t\t\t\tuniform float bloomStrength;\t\t\t\tuniform float bloomRadius;\t\t\t\tuniform float bloomFactors[NUM_MIPS];\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\t\t\t\t\t\t\t\tfloat lerpBloomFactor(const in float factor) { \t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\t\t\t\t}\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\t\t\t\t}"})}}),C.BlurDirectionX=new v.FM8(1,0),C.BlurDirectionY=new v.FM8(0,1);var S=r(377),M=r.n(S),k=r(5902),P=r.n(k),D=r(6417);console.log(C);var U=function(e){(0,h.Z)(o,e);var t=(0,d.Z)(o);function o(){var e;(0,u.Z)(this,o);for(var a=arguments.length,c=new Array(a),h=0;h<a;h++)c[h]=arguments[h];return(e=t.call.apply(t,[this].concat(c))).state={loadingProcess:0,sceneReady:!1},e.initThree=function(){var e={width:window.innerWidth,height:window.innerHeight},t=new v.CP7({canvas:document.querySelector("canvas.webgl"),antialias:!0,alpha:!0});t.setPixelRatio(Math.min(window.devicePixelRatio,2)),t.setSize(e.width,e.height),t.autoClear=!1,t.setClearAlpha(0),t.physicallyCorrectLights=!0,t.toneMapping=v.YGz,t.toneMappingExposure=2;var o=new v.xsS,a=new v.cPb(75,e.width/e.height,.1,1e4);a.position.set(0,1,5);var u=new m.z(a,t.domElement);u.enableDamping=!0,u.enablePan=!1,u.minPolarAngle=.5,u.maxPolarAngle=2.5,u.minAzimuthAngle=-1,u.maxAzimuthAngle=1,window.addEventListener("resize",(function(){e.width=window.innerWidth,e.height=window.innerHeight,t.setSize(e.width,e.height),t.setPixelRatio(Math.min(window.devicePixelRatio,2)),a.aspect=e.width/e.height,a.updateProjectionMatrix()}));var c=new v.Mig(16777215,1.2);o.add(c);var h=new v.Ox3("#ffffff",4);h.castShadow=!0,h.shadow.camera.far=15,h.shadow.mapSize.set(1024,1024),h.shadow.normalBias=.05,h.position.set(.25,3,-1.25),o.add(h);var d=2.39,f=0,b=.38,T=[1,5,1],x=[2,20,2],S=[44,97,15],k=[14,28,5],D=[255,255,255],U=[74,145,0],I=new v.dpR,R=new v.BKK(8,8,1,1),A=new v.jyz({uniforms:{time:{type:"f",value:0},perlinnoise:{type:"t",value:I.load(r(9340))},sparknoise:{type:"t",value:I.load(r(8941))},waterturbulence:{type:"t",value:I.load(r(6316))},noiseTex:{type:"t",value:I.load(r(4543))},color5:{value:s(v.Pa4,(0,l.Z)(U))},color4:{value:s(v.Pa4,(0,l.Z)(D))},color3:{value:s(v.Pa4,(0,l.Z)(k))},color2:{value:s(v.Pa4,(0,l.Z)(S))},color1:{value:s(v.Pa4,(0,l.Z)(x))},color0:{value:s(v.Pa4,(0,l.Z)(T))},resolution:{value:new v.FM8(e.width,e.height)}},fragmentShader:P(),vertexShader:M()}),E=new v.Kj0(R,A);E.layers.set(1),o.add(E);var F=new y.C(o,a),B=new C(new v.FM8(window.innerWidth,window.innerHeight),1.5,.4,.85);B.threshold=f,B.strength=d,B.radius=b;var O=new _.xC(t);O.renderToScreen=!0,O.addPass(F),O.addPass(B);var L=new v.lLk;L.onProgress=function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,i){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}();var z=new g._;z.setDecoderPath("libs/draco/"),z.setDecoderConfig({type:"js"});var j=new w.E(L);j.setDRACOLoader(z);var Z=null;j.load(r(4e3),(function(e){e.scene&&(e.scene.scale.set(.02,.02,.02),e.scene.position.x=-.5,e.scene.rotation.y=Math.PI,e.scene.layers.set(0),o.add(e.scene),Z=e.scene)}));var N=new v.SUY;!function e(r){!function(e){A.uniforms.time.value=e/5e3,A.uniforms.color5.value=s(v.Pa4,(0,l.Z)(U)),A.uniforms.color4.value=s(v.Pa4,(0,l.Z)(D)),A.uniforms.color3.value=s(v.Pa4,(0,l.Z)(k)),A.uniforms.color2.value=s(v.Pa4,(0,l.Z)(S)),A.uniforms.color1.value=s(v.Pa4,(0,l.Z)(x)),A.uniforms.color0.value=s(v.Pa4,(0,l.Z)(T))}(r),t.clear(),a.layers.set(1),O.render(),t.clearDepth(),a.layers.set(0),t.render(o,a);var n=.5*N.getElapsedTime();Z&&(Z.rotation.x=.2*Math.cos(n),Z.rotation.z=.1*Math.sin(n),Z.position.z+=.005*Math.cos(n));var i=2*Math.cos(n)+3;E&&E.scale.set(i,i,i),u&&u.update(),p.w&&p.w.update(),window.requestAnimationFrame(e)}()},e}return(0,c.Z)(o,[{key:"componentDidMount",value:function(){this.initThree()}},{key:"componentWillUnmount",value:function(){this.setState=function(){}}},{key:"render",value:function(){return(0,D.jsxs)("div",{className:"rick_and_morty_page",children:[(0,D.jsx)("canvas",{className:"webgl"}),(0,D.jsx)("i",{className:"logo"}),(0,D.jsxs)("a",{className:"github",href:"https://github.com/dragonir/3d",target:"_blank",rel:"noreferrer",children:[(0,D.jsx)("svg",{height:"36","aria-hidden":"true",viewBox:"0 0 16 16",version:"1.1",width:"36","data-view-component":"true",children:(0,D.jsx)("path",{fill:"#FFFFFF",fillRule:"evenodd",d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"})}),(0,D.jsx)("span",{className:"author",children:"@dragonir"})]})]})}}]),o}(f.Component)},5902:function(e){e.exports="#define NUM_OCTAVES 5\r\n#define M_PI 3.1415926535897932384626433832795\r\nuniform vec4 resolution;\r\nvarying vec3 vNormal;\r\nuniform sampler2D perlinnoise;\r\nuniform sampler2D sparknoise;\r\nuniform sampler2D waterturbulence;\r\nuniform sampler2D noiseTex;\r\nuniform float time;\r\nuniform vec3 color0;\r\nuniform vec3 color1;\r\nuniform vec3 color2;\r\nuniform vec3 color3;\r\nuniform vec3 color4;\r\nuniform vec3 color5;\r\nvarying vec3 camPos;\r\nvarying vec2 vUv;\r\n\r\nfloat rand(vec2 n) {\r\n  return fract(sin(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\r\n}\r\n\r\nfloat noise(vec2 p){\r\n  vec2 ip = floor(p);\r\n  vec2 u = fract(p);\r\n  u = u*u*(3.0-2.0*u);\r\n\r\n  float res = mix(\r\n    mix(rand(ip),rand(ip+vec2(1.0,0.0)),u.x),\r\n    mix(rand(ip+vec2(0.0,1.0)),rand(ip+vec2(1.0,1.0)),u.x),u.y);\r\n  return res*res;\r\n}\r\n\r\nfloat fbm(vec2 x) {\r\n  float v = 0.0;\r\n  float a = 0.5;\r\n  vec2 shift = vec2(100);\r\n  // \u65cb\u8f6c\u4ee5\u51cf\u5c11\u8f74\u5411\u504f\u7f6e\r\n  mat2 rot = mat2(cos(0.5), sin(0.5), -sin(0.5), cos(0.50));\r\n  for (int i = 0; i < NUM_OCTAVES; ++i) {\r\n    v += a * noise(x);\r\n    x = rot * x * 2.0 + shift;\r\n    a *= 0.5;\r\n  }\r\n  return v;\r\n}\r\n\r\n  float setOpacity(float r, float g, float b, float tonethreshold) {\r\n  float tone = (r + g + b) / 3.0;\r\n  float alpha = 1.0;\r\n  if(tone<tonethreshold) {\r\n    alpha = 0.0;\r\n  }\r\n  return alpha;\r\n}\r\n\r\nvec3 rgbcol(vec3 col) {\r\n  return vec3(col.r/255.0,col.g/255.0,col.b/255.0);\r\n}\r\n\r\nvec2 rotate(vec2 v, float a) {\r\n  float s = sin(a);\r\n  float c = cos(a);\r\n  mat2 m = mat2(c, -s, s, c);\r\n  return m * v;\r\n}\r\n\r\nvec2 UnityPolarCoordinates (vec2 UV, vec2 Center, float RadialScale, float LengthScale){\r\n  vec2 delta = UV - Center;\r\n  float radius = length(delta) * 2. * RadialScale;\r\n  float angle = atan(delta.x, delta.y) * 1.0/6.28 * LengthScale;\r\n  return vec2(radius, angle);\r\n}\r\n\r\nvoid main() {\r\n  vec2 olduv = gl_FragCoord.xy/resolution.xy ;\r\n  vec2 uv = vUv ;\r\n  vec2 imguv = uv;\r\n  float scale = 1.;\r\n  olduv *= 0.5 + time;\r\n  olduv.y = olduv.y ;\r\n  vec2 p = olduv*scale;\r\n  float noise = fbm( p  )*0.04;\r\n  vec4 txt = texture2D(perlinnoise, olduv);\r\n  float gradient = dot(normalize( -camPos ), normalize( vNormal ));\r\n  float pct = distance(vUv,vec2(0.5));\r\n\r\n  vec3 rgbcolor0 = rgbcol(color0);\r\n  vec3 rgbcolor1 = rgbcol(color1);\r\n  vec3 rgbcolor2 = rgbcol(color2);\r\n  vec3 rgbcolor3 = rgbcol(color3);\r\n  vec3 rgbcolor4 = rgbcol(color4);\r\n  vec3 rgbcolor5 = rgbcol(color5);\r\n\r\n  // \u8bbe\u7f6e\u7eaf\u8272\u80cc\u666f\r\n  float y = smoothstep(0.16,0.525,pct);\r\n  vec3 backcolor = mix(rgbcolor0, rgbcolor5, y);\r\n\r\n  gl_FragColor = vec4(backcolor,1.);\r\n\r\n  // \u8bbe\u7f6e\u6781\u5750\u6807\r\n  vec2 center = vec2(0.5);\r\n  vec2 cor = UnityPolarCoordinates(vUv, center, 1., 1.);\r\n  vec2 newvUv = vUv - 0.5;\r\n  vec3 noisetexvUv = texture2D(perlinnoise,mod(rotate(newvUv*0.15 + vec2(sin(time*0.005),cos(time*0.005)),time),1.)).rgb;\r\n\r\n  // \u8bbe\u7f6e\u7eb9\u7406\r\n  vec2 newUv = vec2(cor.x + time,cor.x+cor.y);\r\n  vec3 noisetex = texture2D(perlinnoise,mod(newUv,1.)).rgb;\r\n  vec3 noisetex2 = texture2D(sparknoise,mod(newUv,1.)).rgb;\r\n  vec3 noisetex3 = texture2D(waterturbulence,mod(newUv,1.)).rgb;\r\n\r\n  // \u8bbe\u7f6e\u7eb9\u7406\u8272\u8c03\r\n  float tone0 =  1. - smoothstep(0.3,0.6,noisetex.r);\r\n  float tone1 =  smoothstep(0.3,0.6,noisetex2.r);\r\n  float tone2 =  smoothstep(0.3,0.6,noisetex3.r);\r\n\r\n  // \u8bbe\u7f6e\u6bcf\u4e2a\u8272\u8c03\u7684\u4e0d\u900f\u660e\u5ea6\r\n  float opacity0 = setOpacity(tone0,tone0,tone0,.29);\r\n  float opacity1 = setOpacity(tone1,tone1,tone1,.49);\r\n  float opacity2 = setOpacity(tone2,tone2,tone2,.69);\r\n\r\n  // \u5efa\u7acb\u5706\u5f62\u566a\u58f0\r\n  float gradienttone = 1. - smoothstep(0.196,0.532,pct);\r\n  vec4 circularnoise = vec4( vec3(gradienttone)*noisetexvUv*1.4, 1.0 );\r\n  float gradopacity = setOpacity(circularnoise.r,circularnoise.g,circularnoise.b,0.19);\r\n\r\n  // \u8bbe\u7f6e\u8fb9\u7f18\u9759\u6001\u95ea\u5149\r\n  vec2 uv2 = uv;\r\n  float iTime = time*0.004;\r\n  uv.y += iTime / 10.0;\r\n  uv.x -= (sin(iTime/10.0)/2.0);\r\n  uv2.x += iTime / 14.0;\r\n  uv2.x += (sin(iTime/10.0)/9.0);\r\n  float result = 0.0;\r\n  result += texture2D(noiseTex, mod(uv*0.5,1.) * 0.6 + vec2(iTime*-0.003)).r;\r\n  result *= texture2D(noiseTex, mod(uv2*0.5,1.) * 0.9 + vec2(iTime*+0.002)).b;\r\n  result = pow(result, 4.0);\r\n\r\n  // \u8bbe\u7f6e\u6700\u7ec8\u6e32\u67d3\r\n  if(opacity2>0.0){\r\n    gl_FragColor = vec4(rgbcolor4,0.)*vec4(opacity2);\r\n  } else if(opacity1>0.0){\r\n    gl_FragColor = vec4(rgbcolor2,0.)*vec4(opacity1);\r\n  } else if(opacity0>0.0){\r\n    gl_FragColor = vec4(rgbcolor1,0.)*vec4(opacity0);\r\n  }\r\n  gl_FragColor += vec4(108.0)*result*(y*0.02);\r\n  gl_FragColor *= vec4(gradopacity);\r\n}"},377:function(e){e.exports="varying vec3 vNormal;\r\nvarying vec3 camPos;\r\nvarying vec2 vUv;\r\n\r\nvoid main() {\r\n  vNormal = normal;\r\n  vUv = uv;\r\n  camPos = cameraPosition;\r\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n}"},4e3:function(e,t,r){"use strict";e.exports=r.p+"static/media/rickAndMorty.7084bfcab48902308e73.glb"},4543:function(e,t,r){"use strict";e.exports=r.p+"static/media/noise.bc66b00a9c9a0cb00284.png"},9340:function(e,t,r){"use strict";e.exports=r.p+"static/media/perlinnoise.b920496e22a2f32c9106.png"},8941:function(e,t,r){"use strict";e.exports=r.p+"static/media/sparknoise.c105ef53f2bf56c926d5.png"},6316:function(e,t,r){"use strict";e.exports=r.p+"static/media/waterturbulence.2e8fc259fc59a9921f6e.png"},2982:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(907);var i=r(181);function o(e){return function(e){if(Array.isArray(e))return(0,n.Z)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||(0,i.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},6892:function(e,t,r){"use strict";r.d(t,{w:function(){return o}});var n=function(){this._tweens={},this._tweensAddedDuringUpdate={}};n.prototype={getAll:function(){return Object.keys(this._tweens).map(function(e){return this._tweens[e]}.bind(this))},removeAll:function(){this._tweens={}},add:function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},remove:function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},update:function(e,t){var r=Object.keys(this._tweens);if(0===r.length)return!1;for(e=void 0!==e?e:o.now();0<r.length;){this._tweensAddedDuringUpdate={};for(var n=0;n<r.length;n++){var i=this._tweens[r[n]];i&&!1===i.update(e)&&(i._isPlaying=!1,t||delete this._tweens[r[n]])}r=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var i,o=new n;o.Group=n,o._nextId=0,o.nextId=function(){return o._nextId++},"undefined"==typeof self&&"undefined"!=typeof process&&process.hrtime?o.now=function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?o.now=self.performance.now.bind(self.performance):void 0!==Date.now?o.now=Date.now:o.now=function(){return(new Date).getTime()},o.Tween=function(e,t){this._object=e,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=o.Easing.Linear.None,this._interpolationFunction=o.Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=t||o,this._id=o.nextId()},o.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(e,t){return this._valuesEnd=Object.create(e),void 0!==t&&(this._duration=t),this},duration:function(e){return this._duration=e,this},start:function(e){for(var t in this._group.add(this),this._isPlaying=!0,this._onStartCallbackFired=!1,this._startTime=void 0!==e?"string"==typeof e?o.now()+parseFloat(e):e:o.now(),this._startTime+=this._delayTime,this._valuesEnd){if(this._valuesEnd[t]instanceof Array){if(0===this._valuesEnd[t].length)continue;this._valuesEnd[t]=[this._object[t]].concat(this._valuesEnd[t])}void 0!==this._object[t]&&(this._valuesStart[t]=this._object[t],this._valuesStart[t]instanceof Array==0&&(this._valuesStart[t]*=1),this._valuesStartRepeat[t]=this._valuesStart[t]||0)}return this},stop:function(){return this._isPlaying&&(this._group.remove(this),this._isPlaying=!1,null!==this._onStopCallback&&this._onStopCallback(this._object),this.stopChainedTweens()),this},end:function(){return this.update(1/0),this},stopChainedTweens:function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop()},group:function(e){return this._group=e,this},delay:function(e){return this._delayTime=e,this},repeat:function(e){return this._repeat=e,this},repeatDelay:function(e){return this._repeatDelayTime=e,this},yoyo:function(e){return this._yoyo=e,this},easing:function(e){return this._easingFunction=e,this},interpolation:function(e){return this._interpolationFunction=e,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(e){return this._onStartCallback=e,this},onUpdate:function(e){return this._onUpdateCallback=e,this},onComplete:function(e){return this._onCompleteCallback=e,this},onStop:function(e){return this._onStopCallback=e,this},update:function(e){var t,r,n;if(e<this._startTime)return!0;for(t in!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),r=(e-this._startTime)/this._duration,r=0===this._duration||1<r?1:r,n=this._easingFunction(r),this._valuesEnd)if(void 0!==this._valuesStart[t]){var i=this._valuesStart[t]||0,o=this._valuesEnd[t];o instanceof Array?this._object[t]=this._interpolationFunction(o,n):("string"==typeof o&&(o="+"===o.charAt(0)||"-"===o.charAt(0)?i+parseFloat(o):parseFloat(o)),"number"==typeof o&&(this._object[t]=i+(o-i)*n))}if(null!==this._onUpdateCallback&&this._onUpdateCallback(this._object),1!==r)return!0;if(0<this._repeat){for(t in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat){if("string"==typeof this._valuesEnd[t]&&(this._valuesStartRepeat[t]=this._valuesStartRepeat[t]+parseFloat(this._valuesEnd[t])),this._yoyo){var a=this._valuesStartRepeat[t];this._valuesStartRepeat[t]=this._valuesEnd[t],this._valuesEnd[t]=a}this._valuesStart[t]=this._valuesStartRepeat[t]}return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=e+this._repeatDelayTime:this._startTime=e+this._delayTime,!0}null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var s=0,l=this._chainedTweens.length;s<l;s++)this._chainedTweens[s].start(this._startTime+this._duration);return!1}},o.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1}},Back:{In:function(e){return e*e*(2.70158*e-1.70158)},Out:function(e){return--e*e*(2.70158*e+1.70158)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((1+t)*e-t)*.5:.5*((e-=2)*e*((1+t)*e+t)+2)}},Bounce:{In:function(e){return 1-o.Easing.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*o.Easing.Bounce.In(2*e):.5*o.Easing.Bounce.Out(2*e-1)+.5}}},o.Interpolation={Linear:function(e,t){var r=e.length-1,n=r*t,i=Math.floor(n),a=o.Interpolation.Utils.Linear;return t<0?a(e[0],e[1],n):1<t?a(e[r],e[r-1],r-n):a(e[i],e[r<i+1?r:i+1],n-i)},Bezier:function(e,t){for(var r=0,n=e.length-1,i=Math.pow,a=o.Interpolation.Utils.Bernstein,s=0;s<=n;s++)r+=i(1-t,n-s)*i(t,s)*e[s]*a(n,s);return r},CatmullRom:function(e,t){var r=e.length-1,n=r*t,i=Math.floor(n),a=o.Interpolation.Utils.CatmullRom;return e[0]===e[r]?(t<0&&(i=Math.floor(n=r*(1+t))),a(e[(i-1+r)%r],e[i],e[(i+1)%r],e[(i+2)%r],n-i)):t<0?e[0]-(a(e[0],e[0],e[1],e[1],-n)-e[0]):1<t?e[r]-(a(e[r],e[r],e[r-1],e[r-1],n-r)-e[r]):a(e[i?i-1:0],e[i],e[r<i+1?r:i+1],e[r<i+2?r:i+2],n-i)},Utils:{Linear:function(e,t,r){return(t-e)*r+e},Bernstein:function(e,t){var r=o.Interpolation.Utils.Factorial;return r(e)/r(t)/r(e-t)},Factorial:function(){var e=[1];return function(t){var r=1;if(e[t])return e[t];for(var n=t;1<n;n--)r*=n;return e[t]=r}}(),CatmullRom:function(e,t,r,n,i){var o=.5*(r-e),a=.5*(n-t),s=i*i;return(2*t-2*r+o+a)*(i*s)+(-3*t+3*r-2*o-a)*s+o*i+t}}},i=void 0,"function"==typeof define&&define.amd?define([],(function(){return o})):"undefined"!=typeof module&&"object"==typeof exports?module.exports=o:void 0!==i&&(i.TWEEN=o)},4849:function(e,t,r){"use strict";r.d(t,{_:function(){return u}});var n=r(5671),i=r(3144),o=r(136),a=r(9388),s=r(3562),l=new WeakMap,u=function(e){(0,o.Z)(r,e);var t=(0,a.Z)(r);function r(e){var i;return(0,n.Z)(this,r),(i=t.call(this,e)).decoderPath="",i.decoderConfig={},i.decoderBinary=null,i.decoderPending=null,i.workerLimit=4,i.workerPool=[],i.workerNextTaskID=1,i.workerSourceURL="",i.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},i.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"},i}return(0,i.Z)(r,[{key:"setDecoderPath",value:function(e){return this.decoderPath=e,this}},{key:"setDecoderConfig",value:function(e){return this.decoderConfig=e,this}},{key:"setWorkerLimit",value:function(e){return this.workerLimit=e,this}},{key:"load",value:function(e,t,r,n){var i=this,o=new s.hH6(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(e){var r={attributeIDs:i.defaultAttributeIDs,attributeTypes:i.defaultAttributeTypes,useUniqueIDs:!1};i.decodeGeometry(e,r).then(t).catch(n)}),r,n)}},{key:"decodeDracoFile",value:function(e,t,r,n){var i={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,i).then(t)}},{key:"decodeGeometry",value:function(e,t){var r=this;for(var n in t.attributeTypes){var i=t.attributeTypes[n];void 0!==i.BYTES_PER_ELEMENT&&(t.attributeTypes[n]=i.name)}var o,a=JSON.stringify(t);if(l.has(e)){var s=l.get(e);if(s.key===a)return s.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var u=this.workerNextTaskID++,c=e.byteLength,h=this._getWorker(u,c).then((function(r){return o=r,new Promise((function(r,n){o._callbacks[u]={resolve:r,reject:n},o.postMessage({type:"decode",id:u,taskConfig:t,buffer:e},[e])}))})).then((function(e){return r._createGeometry(e.geometry)}));return h.catch((function(){return!0})).then((function(){o&&u&&r._releaseTask(o,u)})),l.set(e,{key:a,promise:h}),h}},{key:"_createGeometry",value:function(e){var t=new s.u9r;e.index&&t.setIndex(new s.TlE(e.index.array,1));for(var r=0;r<e.attributes.length;r++){var n=e.attributes[r],i=n.name,o=n.array,a=n.itemSize;t.setAttribute(i,new s.TlE(o,a))}return t}},{key:"_loadLibrary",value:function(e,t){var r=new s.hH6(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((function(t,n){r.load(e,t,void 0,n)}))}},{key:"preload",value:function(){return this._initDecoder(),this}},{key:"_initDecoder",value:function(){var e=this;if(this.decoderPending)return this.decoderPending;var t="object"!==typeof WebAssembly||"js"===this.decoderConfig.type,r=[];return t?r.push(this._loadLibrary("draco_decoder.js","text")):(r.push(this._loadLibrary("draco_wasm_wrapper.js","text")),r.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(r).then((function(r){var n=r[0];t||(e.decoderConfig.wasmBinary=r[1]);var i=c.toString(),o=["/* draco decoder */",n,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join("\n");e.workerSourceURL=URL.createObjectURL(new Blob([o]))})),this.decoderPending}},{key:"_getWorker",value:function(e,t){var r=this;return this._initDecoder().then((function(){if(r.workerPool.length<r.workerLimit){var n=new Worker(r.workerSourceURL);n._callbacks={},n._taskCosts={},n._taskLoad=0,n.postMessage({type:"init",decoderConfig:r.decoderConfig}),n.onmessage=function(e){var t=e.data;switch(t.type){case"decode":n._callbacks[t.id].resolve(t);break;case"error":n._callbacks[t.id].reject(t);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+t.type+'"')}},r.workerPool.push(n)}else r.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));var i=r.workerPool[r.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i}))}},{key:"_releaseTask",value:function(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}},{key:"debug",value:function(){console.log("Task load: ",this.workerPool.map((function(e){return e._taskLoad})))}},{key:"dispose",value:function(){for(var e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}]),r}(s.aNw);function c(){var e,t;function r(e,t,r,n,i,o){var a=o.num_components(),s=r.num_points()*a,l=s*i.BYTES_PER_ELEMENT,u=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,i),c=e._malloc(l);t.GetAttributeDataArrayForAllPoints(r,o,u,l,c);var h=new i(e.HEAPF32.buffer,c,s).slice();return e._free(c),{name:n,array:h,itemSize:a}}onmessage=function(n){var i=n.data;switch(i.type){case"init":e=i.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":var o=i.buffer,a=i.taskConfig;t.then((function(e){var t=e.draco,n=new t.Decoder,s=new t.DecoderBuffer;s.Init(new Int8Array(o),o.byteLength);try{var l=function(e,t,n,i){var o,a,s=i.attributeIDs,l=i.attributeTypes,u=t.GetEncodedGeometryType(n);if(u===e.TRIANGULAR_MESH)o=new e.Mesh,a=t.DecodeBufferToMesh(n,o);else{if(u!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");o=new e.PointCloud,a=t.DecodeBufferToPointCloud(n,o)}if(!a.ok()||0===o.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+a.error_msg());var c={index:null,attributes:[]};for(var h in s){var d=self[l[h]],f=void 0,v=void 0;if(i.useUniqueIDs)v=s[h],f=t.GetAttributeByUniqueId(o,v);else{if(-1===(v=t.GetAttributeId(o,e[s[h]])))continue;f=t.GetAttribute(o,v)}c.attributes.push(r(e,t,o,h,d,f))}u===e.TRIANGULAR_MESH&&(c.index=function(e,t,r){var n=3*r.num_faces(),i=4*n,o=e._malloc(i);t.GetTrianglesUInt32Array(r,i,o);var a=new Uint32Array(e.HEAPF32.buffer,o,n).slice();return e._free(o),{array:a,itemSize:1}}(e,t,o));return e.destroy(o),c}(t,n,s,a),u=l.attributes.map((function(e){return e.array.buffer}));l.index&&u.push(l.index.array.buffer),self.postMessage({type:"decode",id:i.id,geometry:l},u)}catch(c){console.error(c),self.postMessage({type:"error",id:i.id,error:c.message})}finally{t.destroy(s),t.destroy(n)}}))}}}},1935:function(e,t,r){"use strict";r.d(t,{xC:function(){return f}});var n=r(5671),i=r(3144),o=r(3562),a=r(3500),s=r(136),l=r(9388),u=r(6531),c=function(e){(0,s.Z)(r,e);var t=(0,l.Z)(r);function r(e,i){var a;return(0,n.Z)(this,r),(a=t.call(this)).textureID=void 0!==i?i:"tDiffuse",e instanceof o.jyz?(a.uniforms=e.uniforms,a.material=e):e&&(a.uniforms=o.rDY.clone(e.uniforms),a.material=new o.jyz({defines:Object.assign({},e.defines),uniforms:a.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),a.fsQuad=new u.T(a.material),a}return(0,i.Z)(r,[{key:"render",value:function(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}}]),r}(u.w),h=function(e){(0,s.Z)(r,e);var t=(0,l.Z)(r);function r(e,i){var o;return(0,n.Z)(this,r),(o=t.call(this)).scene=e,o.camera=i,o.clear=!0,o.needsSwap=!1,o.inverse=!1,o}return(0,i.Z)(r,[{key:"render",value:function(e,t,r){var n,i,o=e.getContext(),a=e.state;a.buffers.color.setMask(!1),a.buffers.depth.setMask(!1),a.buffers.color.setLocked(!0),a.buffers.depth.setLocked(!0),this.inverse?(n=0,i=1):(n=1,i=0),a.buffers.stencil.setTest(!0),a.buffers.stencil.setOp(o.REPLACE,o.REPLACE,o.REPLACE),a.buffers.stencil.setFunc(o.ALWAYS,n,4294967295),a.buffers.stencil.setClear(i),a.buffers.stencil.setLocked(!0),e.setRenderTarget(r),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),a.buffers.color.setLocked(!1),a.buffers.depth.setLocked(!1),a.buffers.stencil.setLocked(!1),a.buffers.stencil.setFunc(o.EQUAL,1,4294967295),a.buffers.stencil.setOp(o.KEEP,o.KEEP,o.KEEP),a.buffers.stencil.setLocked(!0)}}]),r}(u.w),d=function(e){(0,s.Z)(r,e);var t=(0,l.Z)(r);function r(){var e;return(0,n.Z)(this,r),(e=t.call(this)).needsSwap=!1,e}return(0,i.Z)(r,[{key:"render",value:function(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}]),r}(u.w),f=function(){function e(t,r){if((0,n.Z)(this,e),this.renderer=t,void 0===r){var i={minFilter:o.wem,magFilter:o.wem,format:o.wk1},s=t.getSize(new o.FM8);this._pixelRatio=t.getPixelRatio(),this._width=s.width,this._height=s.height,(r=new o.dd2(this._width*this._pixelRatio,this._height*this._pixelRatio,i)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=r.width,this._height=r.height;this.renderTarget1=r,this.renderTarget2=r.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===a.C&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===c&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new c(a.C),this.clock=new o.SUY}return(0,i.Z)(e,[{key:"swapBuffers",value:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}},{key:"addPass",value:function(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}},{key:"insertPass",value:function(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}},{key:"removePass",value:function(e){var t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}},{key:"isLastEnabledPass",value:function(e){for(var t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}},{key:"render",value:function(e){void 0===e&&(e=this.clock.getDelta());for(var t=this.renderer.getRenderTarget(),r=!1,n=0,i=this.passes.length;n<i;n++){var o=this.passes[n];if(!1!==o.enabled){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(n),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,r),o.needsSwap){if(r){var a=this.renderer.getContext(),s=this.renderer.state.buffers.stencil;s.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),s.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==h&&(o instanceof h?r=!0:o instanceof d&&(r=!1))}}this.renderer.setRenderTarget(t)}},{key:"reset",value:function(e){if(void 0===e){var t=this.renderer.getSize(new o.FM8);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}},{key:"setSize",value:function(e,t){this._width=e,this._height=t;var r=this._width*this._pixelRatio,n=this._height*this._pixelRatio;this.renderTarget1.setSize(r,n),this.renderTarget2.setSize(r,n);for(var i=0;i<this.passes.length;i++)this.passes[i].setSize(r,n)}},{key:"setPixelRatio",value:function(e){this._pixelRatio=e,this.setSize(this._width,this._height)}}]),e}(),v=(new o.iKG(-1,1,1,-1,0,1),new o.u9r);v.setAttribute("position",new o.a$l([-1,3,0,-1,-1,0,3,-1,0],3)),v.setAttribute("uv",new o.a$l([0,2,0,0,2,0],2))},6531:function(e,t,r){"use strict";r.d(t,{T:function(){return u},w:function(){return a}});var n=r(5671),i=r(3144),o=r(3562),a=function(){function e(){(0,n.Z)(this,e),this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}return(0,i.Z)(e,[{key:"setSize",value:function(){}},{key:"render",value:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}]),e}(),s=new o.iKG(-1,1,1,-1,0,1),l=new o.u9r;l.setAttribute("position",new o.a$l([-1,3,0,-1,-1,0,3,-1,0],3)),l.setAttribute("uv",new o.a$l([0,2,0,0,2,0],2));var u=function(){function e(t){(0,n.Z)(this,e),this._mesh=new o.Kj0(l,t)}return(0,i.Z)(e,[{key:"dispose",value:function(){this._mesh.geometry.dispose()}},{key:"render",value:function(e){e.render(this._mesh,s)}},{key:"material",get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}]),e}()},6938:function(e,t,r){"use strict";r.d(t,{C:function(){return l}});var n=r(5671),i=r(3144),o=r(136),a=r(9388),s=r(3562),l=function(e){(0,o.Z)(r,e);var t=(0,a.Z)(r);function r(e,i,o,a,l){var u;return(0,n.Z)(this,r),(u=t.call(this)).scene=e,u.camera=i,u.overrideMaterial=o,u.clearColor=a,u.clearAlpha=void 0!==l?l:0,u.clear=!0,u.clearDepth=!1,u.needsSwap=!1,u._oldClearColor=new s.Ilk,u}return(0,i.Z)(r,[{key:"render",value:function(e,t,r){var n,i,o=e.autoClear;e.autoClear=!1,void 0!==this.overrideMaterial&&(i=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),n=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:r),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,n),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=i),e.autoClear=o}}]),r}(r(6531).w)},3500:function(e,t,r){"use strict";r.d(t,{C:function(){return n}});var n={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\t\t}"}},5349:function(e,t,r){"use strict";r.d(t,{Y:function(){return n}});var n={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new(r(3562).Ilk)(0)},defaultOpacity:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform vec3 defaultColor;\n\t\tuniform float defaultOpacity;\n\t\tuniform float luminosityThreshold;\n\t\tuniform float smoothWidth;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\n\t\t\tvec3 luma = vec3( 0.299, 0.587, 0.114 );\n\n\t\t\tfloat v = dot( texel.xyz, luma );\n\n\t\t\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\n\t\t\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\t\t\tgl_FragColor = mix( outputColor, texel, alpha );\n\n\t\t}"}}}]);